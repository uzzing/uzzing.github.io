---
title:  "[Development] CI / CD"
date: 2022-8-16 3:00PM
excerpt: "Dev"

author: Yuha
categories: [Development]
tags: [eng]

#toc: true
#toc_sticky: true
 
last_modified_at: 2022-8-17 9:50AM
---

# What is CI CD pipeline?
```
a series of steps that must be performed 
in order to deliver a new version of software 
(bulding > testing > deploying)
```
`CI`
: Continous Integration
> helps developers merge and test code more frequently, even on a daily basis.
> CI requires that all tests are automated.

`CD`
: Continuous Deployment / Conitnous Delivery
> the next step in the process where the tested code from continuous integration is automatically deployed in various environments by a manual trigger.
> In continuous delivery, developers need to push changes to their production environment manually.

<img width="1488" alt="Screen Shot 2022-08-16 at 2 23 07 PM" src="https://user-images.githubusercontent.com/83699657/184804197-b9bad41d-181a-4cdd-9b7d-35b30ff0d923.png">


---
# Benefits 
- Less risk: automated tests reduce the chance of introducing bugs, creating a safety net that increases the developer’s confidence in their code.

- More frequent releases: the automation provided by continuous delivery and continuous deployment allows developers to release and deploy software safely many times per day.

- Improved productivity: freed from the manual labor of building and testing the code, developers can focus on the creative aspects of coding.

- Elevated quality: CI acts as a quality gate, preventing code that is not up to standards from getting released.

- Better design: the iterative nature of continuous integration lets developers work in small increments, allowing a higher degree of experimentation, which leads to more innovative ideas.

---

<img width="1372" alt="Screen Shot 2022-08-16 at 2 15 26 PM" src="https://user-images.githubusercontent.com/83699657/184804178-3ce493f5-b6bd-4cad-bacf-d690a39a928a.png">
<img width="1383" alt="Screen Shot 2022-08-16 at 2 16 22 PM" src="https://user-images.githubusercontent.com/83699657/184804181-7411074b-a8d3-41e4-a679-143eaac7b634.png">
<img width="1403" alt="Screen Shot 2022-08-16 at 2 17 20 PM" src="https://user-images.githubusercontent.com/83699657/184804184-9e1a2ab2-1736-4d7d-9467-77c47baf102f.png">
<img width="1420" alt="Screen Shot 2022-08-16 at 2 18 22 PM" src="https://user-images.githubusercontent.com/83699657/184804189-aa9490c3-8b04-43f7-9304-c8215bc770fe.png">

<img width="1261" alt="Screen Shot 2022-08-16 at 2 33 03 PM" src="https://user-images.githubusercontent.com/83699657/184805061-e82497ad-2408-4c4f-a013-b8a47d4e64a0.png">


- reference : <https://www.youtube.com/watch?v=0Emq5FypiMM>

---
# Example
![ci:cd](https://user-images.githubusercontent.com/83699657/184856450-fce19522-8885-4fc3-ac73-b0fa1682f424.png)

- reference : <https://crispyblog.kr/development/common/8>


<img width="750" alt="cicd3" src="https://user-images.githubusercontent.com/83699657/185009688-ae156e79-4ecc-45e4-9277-8fc0e2a69b5b.png">

- reference : <https://velog.io/@haeny01/AWS-Jenkins%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-Docker-x-SpringBoot-CICD-%EA%B5%AC%EC%B6%95>

---
# Example) Jenkins
<img width="761" alt="Screen Shot 2022-08-16 at 2 33 24 PM" src="https://user-images.githubusercontent.com/83699657/184805205-b6f5d5c7-e15b-4efa-a542-17ffb063c900.png">

## Unit Test (In Java case : Jacoco + JUnit)

### jacoco 
  - a library checking Java code coverage
  - 테스트코드를 돌리고 그 커버리지 결과를 눈으로 보기 좋도록 html이나 xml, csv 같은 리포트로 생성합니다. 
  - 테스트 결과가 내가 설정한 커버리지 기준을 만족하는지 확인하는 기능도 있습니다.
  - import to Gradle configuration
  - `jacocoTestReport`
    : binary coverage 결과를 사람이 보기 편한 형태의 report로 저장(html, xml, csv...)
  - `jacocoTestCoverageVerification`
    : 내가 원하는 coverage 기준을 설정


```java

jacocoTestReport {
  reports {
    // 원하는 리포트를 켜고 끌 수 있습니다.
    html.enabled true
    xml.enabled false
    csv.enabled false

//  각 리포트 타입 마다 리포트 저장 경로를 설정할 수 있습니다.
//  html.destination file("$buildDir/jacocoHtml")
//  xml.destination file("$buildDir/jacoco.xml")

// dependsOn으로 실행 순서 지정 가능
  dependsOn (`:test`,
            `:jacocoTestReport`,
            `:jacocoTestCoverageVerification`)
  }
}

jacocoTestCoverageVerification {
  violationRules {
    rule {
      element = 'CLASS'

      limit {
        counter = 'BRANCH'
        value = 'COVEREDRATIO'
        minimum = 0.90
      }
    }
  }
}

// default
test {
  jacoco {
    enabled = true
    destinationFile = file("$buildDir/jacoco/$.exec")
    includes = []
    excludes = []
    excludeClassLoaders = []
    includeNoLocationClasses = false
    sessionId = "<auto-generated value>"
    dumpOnExit = true
    classDumpDir = null
    output = JacocoTaskExtension.Output.FILE
    address = "localhost"
    port = 6300
    jmx = false
  }
}
```
- reference : <<https://techblog.woowahan.com/2661/>


### JUnit
  -  a simple Java <b>unit testing</b> framework
  - Annotations
    ![junit](https://user-images.githubusercontent.com/83699657/184821220-80f1db62-2a4b-40c7-9224-808c0523b6d5.png)
    - @Test
    - @BeforeEach
    - @AfterEach
    - @DisplayName

    
  - Assert...
    - assertEquals
    - asssertThat().isEqualsTo()
    - assertAll
  
  ** vs <b>org.springframework.util.Assert</b>
    - not for test code
    - often used to parameter verification

`build.gradle`
```java
test {
  useJUnitPlatform()
}
```

`Test.java`
```java
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.Assertions;

public class CaluratorTest {                                            @Test 
  public void testSum() {
    // ... 
    Assertions.assertEquals(...);
  }}
```




- reference : 
<https://phoenixnap.com/kb/what-is-jenkins>
<br>

<https://epthffh.tistory.com/entry/Junit%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8B%A8%EC%9C%84%ED%85%8C%EC%8A%A4%ED%8A%B8>
<br>




---
# Example) Gitlab CI/CD
Use `.gitlab-ci.yml` for automation
- how to make [.gitlab-ci.yml]
<https://buildkite.com/ci-cd>

---
# Example) BuildKite
<https://buildkite.com/ci-cd>


---

# Interview Questions
- reference : <https://semaphoreci.com/blog/common-cicd-interview-questions>
